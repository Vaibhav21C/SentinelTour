<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Registration - Meghalaya Travel</title>
    <meta name="description" content="Register for a Meghalaya Travel account">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Change blue background to grey and make text white */
        .bg-primary,
        .card-header.bg-primary {
            background-color: #6c757d !important;
            color: white !important;
        }
        .bg-primary h2,
        .card-header.bg-primary h2 {
            color: white !important;
        }
    </style>
    <script src="main.js" defer></script>
</head>
<body>
    <!-- Navbar -->
    <header class="fixed-top">
        <nav class="navbar navbar-expand-lg navbar-light bg-white py-3 shadow-sm">
            <div class="container">
                <!-- Logo -->
                <a class="navbar-brand d-flex align-items-center" href="index.html">
                    <img src="images/Site logo.png" alt="Site Logo" height="110" class="me-4" style="border-radius: 12px; width: auto; min-width: 280px; max-width: 400px; object-fit: contain;">
                </a>

                <!-- Mobile Menu Button -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Navigation Content -->
                <div class="collapse navbar-collapse" id="navbarContent">
                    <!-- Main Navigation -->
                    <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="destinations.html">Destinations</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="experiences.html">Experiences</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="about.html">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="useful-info.html">Travel Info</a>
                        </li>
                    </ul>

                    <!-- Right Side Icons -->
                    <div class="d-flex align-items-center">
                        <button class="btn btn-link text-dark me-3" aria-label="Search">
                            <i class="fas fa-search"></i>
                        </button>
                        <button class="btn btn-link text-dark me-3" aria-label="Favorites">
                            <i class="fas fa-heart"></i>
                        </button>
                        
                        <!-- Login Dropdown Menu -->
                        <div class="dropdown">
                            <button class="btn btn-primary rounded-pill px-3 dropdown-toggle" type="button" id="loginDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user me-2"></i> Sign In
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="loginDropdown">
                                <li><h6 class="dropdown-header">Choose Login Option</h6></li>
                                <li><a class="dropdown-item" href="user-login.html"><i class="fas fa-sign-in-alt me-2"></i>User Login</a></li>
                                <li><a class="dropdown-item active" href="user-registration.html"><i class="fas fa-user-plus me-2"></i>User Registration</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="authority-login.html"><i class="fas fa-user-shield me-2"></i>Authority Login</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    
    <!-- Spacer for fixed header -->
    <div class="header-spacer"></div>

    <main>
        <!-- Registration Section -->
        <section class="registration-section py-5">
            <div class="container py-4">
                <div class="row justify-content-center">
                    <div class="col-md-8 col-lg-6">
                        <div class="card shadow-lg border-0 rounded-lg">
                            <div class="card-header bg-primary text-white text-center py-4">
                                <h2 class="fw-light mb-0">Create Your Account</h2>
                            </div>
                            <div class="card-body p-5">
                                <div class="text-center mb-4">
                                    <p class="text-muted">Join Meghalaya 360° to plan your perfect trip to the Abode of Clouds</p>
                                </div>
                                
                                <form id="registrationForm">
                                    <!-- Full Name -->
                                    <div class="mb-3">
                                        <label for="fullName" class="form-label">Full Name</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-user"></i></span>
                                            <input type="text" class="form-control" id="fullName" name="fullName" placeholder="Enter your full name" required>
                                        </div>
                                    </div>
                                    
                                    <!-- Email ID -->
                                    <div class="mb-3">
                                        <label for="email" class="form-label">Email ID</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                            <input type="email" class="form-control" id="email" name="email" placeholder="Enter your email ID" required>
                                        </div>
                                    </div>
                                    
                                    <!-- Nationality -->
                                    <div class="mb-3">
                                        <label for="nationality" class="form-label">Nationality</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-flag"></i></span>
                                            <select class="form-select" id="nationality" name="nationality" required>
                                                <option value="" selected disabled>Select your nationality</option>
                                                <option value="indian">Indian</option>
                                                <option value="american">American</option>
                                                <option value="british">British</option>
                                                <option value="canadian">Canadian</option>
                                                <option value="australian">Australian</option>
                                                <option value="german">German</option>
                                                <option value="french">French</option>
                                                <option value="japanese">Japanese</option>
                                                <option value="chinese">Chinese</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <!-- Aadhaar Number -->
                                    <div class="mb-3">
                                        <label for="aadhaar" class="form-label">Aadhaar Number</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-id-card"></i></span>
                                            <input type="text" class="form-control" id="aadhaar" name="aadhaar" placeholder="Enter your 12-digit Aadhaar number" maxlength="12" pattern="[0-9]{12}" required>
                                        </div>
                                        <div class="form-text">Enter 12-digit Aadhaar number without spaces</div>
                                    </div>
                                    
                                    <!-- Phone Number -->
                                    <div class="mb-3">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="Enter your phone number" pattern="[0-9]{10}" maxlength="10" required>
                                        </div>
                                        <div class="form-text">Enter 10-digit mobile number</div>
                                    </div>
                                    
                                    <!-- OTP Generation -->
                                    <div class="mb-3">
                                        <label for="otp" class="form-label">OTP Verification</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-key"></i></span>
                                            <input type="text" class="form-control" id="otp" name="otp" placeholder="Enter OTP" maxlength="6" pattern="[0-9]{6}" required>
                                            <button class="btn btn-outline-primary" type="button" id="generateOTP">
                                                <i class="fas fa-paper-plane me-1"></i> Send OTP
                                            </button>
                                        </div>
                                        <div class="form-text">OTP will be sent to your registered phone number</div>
                                    </div>
                                    
                                    <!-- Create Password -->
                                    <div class="mb-3">
                                        <label for="password" class="form-label">Create Password</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                            <input type="password" class="form-control" id="password" name="password" placeholder="Create a strong password" required>
                                            <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <div class="form-text">Password must be at least 8 characters with letters and numbers</div>
                                    </div>
                                    
                                    <!-- Confirm Password -->
                                    <div class="mb-4">
                                        <label for="confirmPassword" class="form-label">Confirm Password</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm your password" required>
                                        </div>
                                    </div>
                                    
                                    <!-- Photo Capture -->
                                    <div class="mb-4">
                                        <label class="form-label">Upload/Scan Photo</label>
                                        <div class="d-flex flex-column gap-2">
                                            <div class="ratio ratio-4x3 bg-light rounded position-relative overflow-hidden">
                                                <video id="regVideo" autoplay playsinline class="w-100 h-100 d-none" style="object-fit: cover;"></video>
                                                <canvas id="regCanvas" class="d-none"></canvas>
                                                <img id="regSnapshot" class="w-100 h-100 d-none" alt="Photo preview" style="object-fit: cover;" />
                                                <div id="regPlaceholder" class="d-flex align-items-center justify-content-center text-muted">No photo yet</div>
                                            </div>
                                            <div class="d-flex flex-wrap gap-2">
                                                <input type="file" accept="image/*" class="form-control" id="regPhotoInput" style="max-width: 320px;">
                                                <button type="button" class="btn btn-outline-secondary" id="startRegCamera"><i class="fas fa-video me-1"></i> Use Camera</button>
                                                <button type="button" class="btn btn-primary" id="captureRegPhoto" disabled><i class="fas fa-camera me-1"></i> Capture</button>
                                                <button type="button" class="btn btn-outline-warning" id="retakeRegPhoto" disabled><i class="fas fa-redo me-1"></i> Retake</button>
                                            </div>
                                            <div class="form-text">You can upload an existing photo or scan using your camera.</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Terms and Conditions -->
                                    <div class="mb-4 form-check">
                                        <input type="checkbox" class="form-check-input" id="termsCheck" required>
                                        <label class="form-check-label" for="termsCheck">
                                            I agree to the <a href="#" class="text-decoration-none">Terms of Service</a> and <a href="#" class="text-decoration-none">Privacy Policy</a>
                                        </label>
                                    </div>
                                    
                                    <!-- Submit Button -->
                                    <div class="d-grid">
                                        <button type="submit" class="btn btn-primary btn-lg">Create Account</button>
                                    </div>
                                </form>
                            </div>
                            <div class="card-footer text-center py-3 bg-light">
                                <div class="small">
                                    Already have an account? <a href="user-login.html" class="text-decoration-none">Sign in</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-top">
            <div class="container">
                <div class="row gy-4">
                    <div class="col-lg-4">
                        <a href="index.html" class="footer-logo d-flex align-items-center">
                            <img src="images/Site logo.png" alt="Site Logo" height="110" class="me-4" style="border-radius: 12px; width: auto; min-width: 280px; max-width: 400px; object-fit: contain;">
                            <span>Meghalaya 360°</span>
                        </a>
                        <p class="footer-description mt-3">Discover the beauty and charm of Meghalaya, the Abode of Clouds. Plan your perfect getaway with us.</p>
                    </div>
                    <div class="col-lg-2 col-6">
                        <h5 class="footer-heading">Explore</h5>
                        <ul class="footer-links">
                            <li><a href="destinations.html">Destinations</a></li>
                            <li><a href="experiences.html">Experiences</a></li>
                            <li><a href="about.html">About Us</a></li>
                            <li><a href="blog.html">Travel Blog</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-2 col-6">
                        <h5 class="footer-heading">Useful Links</h5>
                        <ul class="footer-links">
                            <li><a href="#">FAQs</a></li>
                            <li><a href="#">Terms of Service</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-4">
                        <h5 class="footer-heading">Stay Connected</h5>
                        <p>Subscribe to our newsletter for travel tips and updates</p>
                        <form class="mt-3">
                            <div class="input-group">
                                <input type="email" class="form-control" placeholder="Your Email" aria-label="Email" aria-describedby="subscribe-btn">
                                <button class="btn btn-primary" type="button" id="subscribe-btn">Subscribe</button>
                            </div>
                        </form>
                        <div class="social-links mt-3">
                            <a href="#" class="twitter"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="instagram"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="youtube"><i class="fab fa-youtube"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom text-center py-3">
            <div class="container">
                <div class="copyright">
                    &copy; <span id="current-year">2023</span> <strong>Meghalaya 360°</strong>. All Rights Reserved.
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AOS Animation Library JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Initialize AOS animation
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
        
        // Update current year in footer
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Toggle password visibility
        document.getElementById('togglePassword').addEventListener('click', function() {
            const passwordInput = document.getElementById('password');
            const icon = this.querySelector('i');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
        
        // OTP Generation
        document.getElementById('generateOTP').addEventListener('click', function() {
            const phone = document.getElementById('phone').value;
            if (!phone || phone.length !== 10) {
                alert('Please enter a valid 10-digit phone number first');
                return;
            }
            
            // Simulate OTP generation
            const otp = Math.floor(100000 + Math.random() * 900000);
            sessionStorage.setItem('generatedOTP', otp);
            
            // In a real application, this would send OTP via SMS
            alert(`OTP sent to ${phone}. For demo purposes, your OTP is: ${otp}`);
            
            // Disable button for 30 seconds
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-clock me-1"></i> Resend in 30s';
            
            setTimeout(() => {
                this.disabled = false;
                this.innerHTML = '<i class="fas fa-paper-plane me-1"></i> Send OTP';
            }, 30000);
        });
        
        // Photo upload and camera capture
        const regVideo = document.getElementById('regVideo');
        const regCanvas = document.getElementById('regCanvas');
        const regSnapshot = document.getElementById('regSnapshot');
        const regPlaceholder = document.getElementById('regPlaceholder');
        const startRegCameraBtn = document.getElementById('startRegCamera');
        const captureRegPhotoBtn = document.getElementById('captureRegPhoto');
        const retakeRegPhotoBtn = document.getElementById('retakeRegPhoto');
        const regPhotoInput = document.getElementById('regPhotoInput');
        let regStream = null;
        let regPhotoDataUrl = '';
        
        function showSnapshot(dataUrl) {
            regSnapshot.src = dataUrl;
            regSnapshot.classList.remove('d-none');
            regPlaceholder.classList.add('d-none');
            regVideo.classList.add('d-none');
            captureRegPhotoBtn.disabled = true;
            retakeRegPhotoBtn.disabled = false;
        }
        
        async function startRegCamera() {
            try {
                regStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' }, audio: false });
                regVideo.srcObject = regStream;
                regVideo.classList.remove('d-none');
                regPlaceholder.classList.add('d-none');
                captureRegPhotoBtn.disabled = false;
                retakeRegPhotoBtn.disabled = true;
            } catch (e) {
                alert('Camera access denied or not available. You can upload a photo instead.');
            }
        }
        
        function stopRegCamera() {
            if (regStream) {
                regStream.getTracks().forEach(t => t.stop());
                regStream = null;
            }
        }
        
        startRegCameraBtn.addEventListener('click', startRegCamera);
        
        captureRegPhotoBtn.addEventListener('click', function() {
            const width = regVideo.videoWidth || 640;
            const height = regVideo.videoHeight || 480;
            regCanvas.width = width;
            regCanvas.height = height;
            regCanvas.getContext('2d').drawImage(regVideo, 0, 0, width, height);
            regPhotoDataUrl = regCanvas.toDataURL('image/jpeg', 0.9);
            showSnapshot(regPhotoDataUrl);
            stopRegCamera();
        });
        
        retakeRegPhotoBtn.addEventListener('click', function() {
            regSnapshot.classList.add('d-none');
            regPlaceholder.classList.remove('d-none');
            regPhotoDataUrl = '';
            captureRegPhotoBtn.disabled = true;
            startRegCamera();
        });
        
        regPhotoInput.addEventListener('change', function(e) {
            const file = e.target.files && e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function() {
                regPhotoDataUrl = String(reader.result);
                showSnapshot(regPhotoDataUrl);
                stopRegCamera();
            };
            reader.readAsDataURL(file);
        });
        
        // Form submission handling
        document.getElementById('registrationForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const nationality = document.getElementById('nationality').value;
            const aadhaar = document.getElementById('aadhaar').value;
            const phone = document.getElementById('phone').value;
            const otp = document.getElementById('otp').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const termsCheck = document.getElementById('termsCheck').checked;
            
            // Basic validation
            if (!fullName || !email || !nationality || !aadhaar || !phone || !otp || !password || !confirmPassword) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (!regPhotoDataUrl) {
                alert('Please add a photo by uploading or capturing via camera');
                return;
            }
            
            if (aadhaar.length !== 12 || !/^\d{12}$/.test(aadhaar)) {
                alert('Please enter a valid 12-digit Aadhaar number');
                return;
            }
            
            if (phone.length !== 10 || !/^\d{10}$/.test(phone)) {
                alert('Please enter a valid 10-digit phone number');
                return;
            }
            
            // Verify OTP
            const generatedOTP = sessionStorage.getItem('generatedOTP');
            if (!generatedOTP || otp !== generatedOTP) {
                alert('Invalid OTP. Please check and try again.');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
            
            if (password.length < 8) {
                alert('Password must be at least 8 characters long');
                return;
            }
            
            if (!termsCheck) {
                alert('Please accept the terms and conditions');
                return;
            }
            
            // Store
            sessionStorage.setItem('userRegistered', 'true');
            sessionStorage.setItem('userName', fullName);
            sessionStorage.setItem('userEmail', email);
            sessionStorage.setItem('userNationality', nationality);
            sessionStorage.setItem('userAadhaar', aadhaar);
            sessionStorage.setItem('userPhone', phone);
            sessionStorage.setItem('userPhoto', regPhotoDataUrl);
            
            alert('Registration successful! Please login to continue.');
            window.location.href = 'user-login.html';
        });
    </script>
    <!-- Chatbot for Registration Page -->
    (function(){
        const chatBtn = document.createElement('button');
        chatBtn.className = 'fab fab-chat btn btn-success';
        chatBtn.title = 'Chat';
        chatBtn.style.borderRadius = '50%';
        chatBtn.style.width = '56px';
        chatBtn.style.height = '56px';
        chatBtn.style.padding = '0';
        chatBtn.innerHTML = '<i class="fab fa-whatsapp" style="font-size:22px"></i>';
        chatBtn.addEventListener('click', openChatWidget);
        document.body.appendChild(chatBtn);

        function openChatWidget(){
            const existing = document.getElementById('regChatWidget');
            if (existing) { existing.classList.remove('d-none'); return; }
            const wrap = document.createElement('div');
            wrap.id = 'regChatWidget';
            wrap.style.position = 'fixed';
            wrap.style.right = '24px';
            wrap.style.bottom = '92px';
            wrap.style.width = '320px';
            wrap.style.height = '420px';
            wrap.style.background = '#fff';
            wrap.style.borderRadius = '12px';
            wrap.style.boxShadow = '0 10px 25px rgba(0,0,0,0.2)';
            wrap.innerHTML = '<div class="d-flex justify-content-between align-items-center p-2 border-bottom"><strong>Registration Help</strong><button class="btn btn-sm btn-outline-secondary" id="regChatClose">×</button></div><div id="regChatBody" style="height:260px;overflow:auto;padding:12px;font-size:14px"></div><div id="regChatSuggestions" class="p-2 border-top" style="display:grid;grid-template-columns:1fr 1fr;gap:6px"></div><div class="p-2 d-flex gap-2 border-top"><input class="form-control" id="regChatInput" placeholder="Type a message..."/><button class="btn btn-primary" id="regChatSend">Send</button></div>';
            document.body.appendChild(wrap);
            const body = wrap.querySelector('#regChatBody');
            const input = wrap.querySelector('#regChatInput');
            const send = wrap.querySelector('#regChatSend');
            const sugg = wrap.querySelector('#regChatSuggestions');

            function addMsg(text, me){ const p=document.createElement('div'); p.className='mb-2'; p.innerHTML = me? `<div class="text-end"><span class="badge bg-primary">${text}</span></div>` : `<span class="badge bg-light text-dark">${text}</span>`; body.appendChild(p); body.scrollTop = body.scrollHeight; }

            const qa = {
                'What documents needed?': 'For demo, only your photo and basic details are required. In production, valid ID may be needed.',
                'How to scan a photo?': 'Click Use Camera, allow permission, then Capture. You can Retake if needed or upload from files.',
                'OTP not received': 'Ensure the 10-digit phone is correct. Try Send OTP again after 30 seconds or check network.',
                'Aadhaar format?': 'Enter exactly 12 digits without spaces. Only numbers are accepted.',
                'Password rules': 'At least 8 characters combining letters and numbers. Confirm password must match.'
            };

            Object.keys(qa).forEach(key => {
                const b = document.createElement('button');
                b.className = 'btn btn-outline-secondary btn-sm';
                b.textContent = key;
                b.addEventListener('click', ()=> handleUserQuestion(key));
                sugg.appendChild(b);
            });
            addMsg('Hi! Need help with registration? Pick a question or type your message.', false);

            function handleUserQuestion(q){
                addMsg(q, true);
                const answer = qa[q] || 'Thanks! Our support team will reach out if needed.';
                setTimeout(()=> addMsg(answer, false), 400);
            }

            send.addEventListener('click', () => { const q=input.value.trim(); if(!q) return; input.value=''; handleUserQuestion(q); });
            wrap.querySelector('#regChatClose').addEventListener('click', ()=> wrap.classList.add('d-none'));
        }
    })();
</body>
</html>